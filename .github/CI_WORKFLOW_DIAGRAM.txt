╔════════════════════════════════════════════════════════════════════╗
║                    LIBRARIE CI/CD PIPELINE                         ║
╚════════════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────────┐
│                    PULL REQUEST / PUSH                           │
│                          ↓                                       │
│              Triggers CI Workflows                               │
└─────────────────────────────────────────────────────────────────┘
                           ↓
    ┌──────────────────────┼──────────────────────┐
    ↓                      ↓                      ↓
┌─────────┐          ┌──────────┐          ┌──────────┐
│ ci.yml  │          │ codeql   │          │ backend/ │
│ Main CI │          │ Security │          │ frontend │
│ Pipeline│          │ Analysis │          │ specific │
└─────────┘          └──────────┘          └──────────┘
    ↓                      ↓                      ↓

┌─────────────────────────────────────────────────────────────────┐
│                    CI.YML - MAIN PIPELINE                        │
└─────────────────────────────────────────────────────────────────┘
    ↓
┌─────────────────┐
│ detect-changes  │  Smart Change Detection
│ Uses path-filter│  (backend/**, frontend/**)
└─────────────────┘
    ↓
    ├─────────────────────────────┬─────────────────┐
    ↓                             ↓                 ↓
┌──────────┐                 ┌──────────┐     ┌───────────┐
│ BACKEND  │  (conditional)  │ FRONTEND │     │ SECURITY  │
│  CI      │  if changed     │   CI     │     │   SCAN    │
└──────────┘                 └──────────┘     └───────────┘
│                             │                 │
│ • Java 21                   │ • Node 20       │ • Trivy   │
│ • Maven cache               │ • npm cache     │ • CRITICAL│
│ • Checkstyle lint           │ • Prettier      │ • HIGH    │
│ • JaCoCo coverage           │ • Karma tests   │ • SARIF   │
│ • Tests (150 ✓)             │ • ng build      │ • Upload  │
│ • Upload artifacts          │ • Artifacts     │           │
└──────────┘                 └──────────┘     └───────────┘
    │                             │                 │
    └─────────────────┬───────────┴─────────────────┘
                      ↓
              ┌───────────────┐
              │  ci-status    │  Final Gate
              │  All must ✓   │  (all jobs pass)
              └───────────────┘
                      ↓
              ┌───────────────┐
              │  ✅ READY TO  │
              │     MERGE     │
              └───────────────┘

┌─────────────────────────────────────────────────────────────────┐
│                 CODEQL - SECURITY ANALYSIS                       │
└─────────────────────────────────────────────────────────────────┘
    ↓
    ├───────────────────┬───────────────────┐
    ↓                   ↓                   ↓
┌──────────┐      ┌──────────┐      ┌──────────┐
│ Analyze  │      │ Analyze  │      │ Schedule │
│  Java    │      │   JS/TS  │      │  Weekly  │
│ Backend  │      │ Frontend │      │  Monday  │
└──────────┘      └──────────┘      └──────────┘
    │                   │                   │
    └───────────────────┴───────────────────┘
                      ↓
              ┌───────────────┐
              │  Upload to    │
              │  GitHub       │
              │  Security Tab │
              └───────────────┘

┌─────────────────────────────────────────────────────────────────┐
│                        ARTIFACTS (7 days)                        │
├─────────────────────────────────────────────────────────────────┤
│ • Backend test results (Surefire reports)                       │
│ • Backend coverage (JaCoCo)                                     │
│ • Frontend test results (Karma coverage)                        │
│ • Frontend build (dist/)                                        │
│ • Security scan (Trivy SARIF)                                   │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│                    REQUIRED STATUS CHECKS                        │
├─────────────────────────────────────────────────────────────────┤
│ 1. ✅ Backend - Build & Test                                    │
│ 2. ✅ Frontend - Build & Test                                   │
│ 3. ✅ Security - Dependency Scan                                │
│ 4. ✅ CI Status Check                                           │
│ 5. ✅ Analyze Code (java)                                       │
│ 6. ✅ Analyze Code (javascript)                                 │
└─────────────────────────────────────────────────────────────────┘

